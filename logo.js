function() {
    'use strict';
    
    // Проверка платформы
    if (!Lampa.Platform.tv()) return;

    (function() {
        function _0x9a1b() {
            var _0xecf889 = ['&language=', 'apply', 'ready', '(((.+)+)+)+$', '854104NewhTz', 'type', 'log', '{}.constructor(\x22return\x20this\x22)(\x20)', '1576425KXhLvM', '<img\x20style=\x22margin-top:\x200.6em;\x20margin-bottom:\x200.4em;\x20max-height:\x202.8em;\x20max-width:\x206.8em;\x22\x20src=\x22', 'api', 'Noty', 't/p/w500', 'constructor', 'follow', 'get', 'interface', '__proto__', 'origin', 'full', 'logo_card', '8582104RQUwyy', 'data', 'length', '<img\x20style=\x22margin-top:\x200.3em;\x20margin-bottom:\x200.1em;\x20max-height:\x201.8em;\x22\x20src=\x22', 'toString', 'TMDB', '.full-start-new__tagline', '/images?api_key=', 'image', 'console', 'Storage', 'info', '2553099uaQqou', 'div[data-name=\x22logo_card\x22]', 'app', 'file_path', 'language', '.full-start-new.cardify', 'addParam', 'movie', 'appready', 'innerWidth', 'logos', 'render', '1012042EYzSYU', 'Ошибка\x20доступа', '.svg', 'show', 'html', '.full-start-new__title', '<img\x20style=\x22margin-top:\x200.3em;\x20margin-bottom:\x200.4em;\x20max-height:\x202.8em;\x22\x20src=\x22', 'trigger', 'Логотип\x20вместо\x20названия', '6oxbFcL', 'bind', '457638vYxaFS', 'insertAfter', 'bylampa', 'prototype', 'Listener', 'hide', 'search', '\x22\x20/>', '.png', 'name', '6452033plzCHZ', 'div[data-name=\x22card_interfice_cover\x22]'];
            _0x9a1b = function() {
                return _0xecf889;
            };
            return _0x9a1b();
        }

        function _0x498c(_0x5f1556, _0x2198e4) {
            var _0x5af6c5 = _0x9a1b();
            return _0x498c = function(_0x429c8c, _0x5930d) {
                _0x429c8c = _0x429c8c - 0xab;
                var _0x3a363e = _0x5af6c5[_0x429c8c];
                return _0x3a363e;
            }, _0x498c(_0x5f1556, _0x2198e4);
        }

        (function(_0x3d9e83, _0x837744) {
            var _0x4d443a = _0x498c,
                _0x3ea309 = _0x3d9e83();
            while (!![]) {
                try {
                    var _0x5b7c78 = parseInt(_0x4d443a(0xd1)) / 0x1 + parseInt(_0x4d443a(0xc6)) / 0x2 + -parseInt(_0x4d443a(0xba)) / 0x3 + parseInt(_0x4d443a(0xe1)) / 0x4 + parseInt(_0x4d443a(0xe5)) / 0x5 + parseInt(_0x4d443a(0xcf)) / 0x6 * (parseInt(_0x4d443a(0xdb)) / 0x7) + -parseInt(_0x4d443a(0xae)) / 0x8;
                    if (_0x5b7c78 === _0x837744) break;
                    else _0x3ea309['push'](_0x3ea309['shift']());
                } catch (_0x33dae4) {
                    _0x3ea309['push'](_0x3ea309['shift']());
                }
            }
        }(_0x9a1b, 0x77b99));

        // Основная функция
        function initPlugin() {
            var _0x593118 = _0x498c;
            
            // Анти-отладка (сохранена из оригинала)
            var _0x425294 = (function() {
                var _0x2ec99d = !![];
                return function(_0x4f7eca, _0x7fe975) {
                    var _0xa38ecf = _0x2ec99d ? function() {
                        if (_0x7fe975) {
                            var _0x11f7cb = _0x7fe975['apply'](_0x4f7eca, arguments);
                            return _0x7fe975 = null, _0x11f7cb;
                        }
                    } : function() {};
                    return _0x2ec99d = ![], _0xa38ecf;
                };
            }());
            
            var _0x2f3c87 = (function() {
                var _0xfa8d24 = !![];
                return function(_0x1255f8, _0x2ae6b7) {
                    var _0x3bee42 = _0xfa8d24 ? function() {
                        var _0x28710f = _0x498c;
                        if (_0x2ae6b7) {
                            var _0x5292e7 = _0x2ae6b7[_0x28710f(0xde)](_0x1255f8, arguments);
                            return _0x2ae6b7 = null, _0x5292e7;
                        }
                    } : function() {};
                    return _0xfa8d24 = ![], _0x3bee42;
                };
            }());

            // Защита console
            (function() {
                var _0x1ce039 = _0x498c,
                    _0x4f216c = function() {
                        var _0x3337d6 = _0x498c,
                            _0x1bb469;
                        try {
                            _0x1bb469 = Function('return\x20(function()\x20' + _0x3337d6(0xe4) + ');')();
                        } catch (_0x10d5bc) {
                            _0x1bb469 = window;
                        }
                        return _0x1bb469;
                    },
                    _0x532a17 = _0x4f216c(),
                    _0x334153 = _0x532a17[_0x1ce039(0xb7)] = _0x532a17[_0x1ce039(0xb7)] || {},
                    _0x2a0d54 = [_0x1ce039(0xe3), 'warn', _0x1ce039(0xb9), 'error', 'exception', 'table', 'trace'];
                    
                for (var _0x31b5e6 = 0x0; _0x31b5e6 < _0x2a0d54[_0x1ce039(0xb0)]; _0x31b5e6++) {
                    var _0x40cc1d = _0x2f3c87[_0x1ce039(0xea)][_0x1ce039(0xd4)][_0x1ce039(0xd0)](_0x2f3c87),
                        _0x199416 = _0x2a0d54[_0x31b5e6],
                        _0x50d0e9 = _0x334153[_0x199416] || _0x40cc1d;
                        
                    _0x40cc1d[_0x1ce039(0xee)] = _0x2f3c87[_0x1ce039(0xd0)](_0x2f3c87);
                    _0x40cc1d[_0x1ce039(0xb2)] = _0x50d0e9['toString'][_0x1ce039(0xd0)](_0x50d0e9);
                    _0x334153[_0x199416] = _0x40cc1d;
                }
            }());

            // Добавление настройки в интерфейс
            Lampa.SettingsApi.addParam({
                component: 'bylampa',
                param: {
                    name: 'logo_card',
                    type: 'trigger',
                    default: true
                },
                field: {
                    name: 'Логотип вместо названия'
                },
                onRender: function() {
                    setTimeout(function() {
                        $('div[data-name="logo_card"]').removeClass('hide');
                    }, 0);
                }
            });

            // Следим за открытием карточки
            Lampa.Listener.follow('full', function(e) {
                if (e.type == 'complite' && Lampa.Storage.get('logo_card') !== false) {
                    var activity = e.object.activity.$body;
                    
                    // Скрываем стандартные элементы
                    $('.full-start-new__title', activity).hide();
                    $('.full-start-new.cardify', activity).hide();
                    
                    var item = e.data.data;
                    var type = item.name ? 'tv' : 'movie';
                    var apiKey = Lampa.TMDB.key();
                    var url = Lampa.TMDB.api(type + '/' + item.id + '/images?api_key=' + apiKey + '&language=' + Lampa.Storage.get('language'));

                    // Загружаем логотипы
                    $.get(url, function(response) {
                        if (response.logos && response.logos[0]) {
                            var logoPath = response.logos[0].file_path;
                            
                            if (logoPath !== '') {
                                $('.full-start-new__title', activity).empty();
                                
                                var logoHtml;
                                if (window.innerWidth > 585) {
                                    if ($('div[data-name="logo_card"]').length) {
                                        logoHtml = '<img style="margin-top: 0.6em; margin-bottom: 0.4em; max-height: 2.8em; max-width: 6.8em;" src="' + 
                                                  Lampa.TMDB.image('t/p/w500' + logoPath.replace('.svg', '.png')) + '" />';
                                    } else {
                                        logoHtml = '<img style="margin-top: 0.3em; margin-bottom: 0.1em; max-height: 1.8em;" src="' + 
                                                  Lampa.TMDB.image('t/p/w500' + logoPath.replace('.svg', '.png')) + '" />';
                                    }
                                    $('div[data-name="logo_card"]', activity).html(logoHtml);
                                } else {
                                    logoHtml = '<img style="margin-top: 0.3em; margin-bottom: 0.1em; max-height: 1.8em;" src="' + 
                                              Lampa.TMDB.image('t/p/w500' + logoPath.replace('.svg', '.png')) + '" />';
                                    $('.full-start-new__title', activity).html(logoHtml);
                                }
                            }
                        } else {
                            $('.full-start-new__title', activity).empty();
                            $('.full-start-new__tagline', activity).empty();
                        }
                    });
                }
            });
        }

        // Запускаем плагин
        if (window.appready) {
            initPlugin();
        } else {
            Lampa.Listener.follow('app', function(e) {
                if (e.type == 'ready') initPlugin();
            });
        }

    }());
}
